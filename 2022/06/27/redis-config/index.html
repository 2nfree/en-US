<!DOCTYPE html><html lang="en_US" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>Redis Transactions And Configuration | Gengar's Pokeball</title><meta name="author" content="komorebi"><meta name="copyright" content="komorebi"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Redis Transactions and Some Advanced Configuration Explained"><meta property="og:type" content="article"><meta property="og:title" content="Redis Transactions And Configuration"><meta property="og:url" content="https://blog.2nfree.com/en-us/2022/06/27/redis-config/"><meta property="og:site_name" content="Gengar&#39;s Pokeball"><meta property="og:description" content="Redis Transactions and Some Advanced Configuration Explained"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://blog.2nfree.com/en-us/images/avatar.png"><meta property="article:published_time" content="2022-06-27T08:03:03.000Z"><meta property="article:modified_time" content="2024-08-26T02:02:45.637Z"><meta property="article:author" content="komorebi"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Shell"><meta property="article:tag" content="Redis"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://blog.2nfree.com/en-us/images/avatar.png"><link rel="shortcut icon" href="/en-us/images/logo.svg"><link rel="canonical" href="https://blog.2nfree.com/en-us/2022/06/27/redis-config/"><link rel="preconnect"><link rel="stylesheet" href="/en-us/css/index.css?v=4.13.0"><link rel="stylesheet" href="/en-us/pluginsSrc/@fortawesome/fontawesome-free/css/all.min.css?v=6.5.1"><script>const GLOBAL_CONFIG={root:"/en-us/",algolia:void 0,localSearch:{path:"/en-us/search.xml",preload:!1,top_n_per_article:1,unescape:!1,languages:{hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found"}},translate:void 0,noticeOutdate:{limitDay:100,position:"top",messagePrev:"This article was updated",messageNext:"days ago, Please verify that the information is still up-to-date."},highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:200},copy:{success:"Copy Successful",error:"Copy Error",noSupport:"Browser Not Supported"},relativeDate:{homepage:!1,post:!1},runtime:"days",dateSuffix:{just:"Just now",min:"minutes ago",hour:"hours ago",day:"days ago",month:"months ago"},copyright:void 0,lightbox:"mediumZoom",Snackbar:void 0,infinitegrid:{js:"/en-us/pluginsSrc/@egjs/infinitegrid/dist/infinitegrid.min.js?v=4.11.1",buttonText:"Load More"},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1,percent:{toc:!0,rightside:!0},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Redis Transactions And Configuration",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-08-26 10:02:45"}</script><script>(e=>{e.saveToLocal={set:(e,t,o)=>{if(0===o)return;const a={value:t,expiry:Date.now()+864e5*o};localStorage.setItem(e,JSON.stringify(a))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!(Date.now()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=(e,t={})=>new Promise((o,a)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},Object.keys(t).forEach(e=>{n.setAttribute(e,t[e])}),document.head.appendChild(n)}),e.getCSS=(e,t=!1)=>new Promise((o,a)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=e,t&&(n.id=t),n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},document.head.appendChild(n)}),e.activateDarkMode=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/en-us/atom.xml" title="Gengar's Pokeball" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{const d=document.getElementById("loading-box"),e=document.body,o=()=>{e.style.overflow="",d.classList.add("loaded")},l=()=>{e.style.overflow="hidden",d.classList.remove("loaded")};l(),window.addEventListener("load",()=>{o()})})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/en-us/images/avatar.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/en-us/archives/"><div class="headline">Articles</div><div class="length-num">29</div></a><a href="/en-us/tags/"><div class="headline">Tags</div><div class="length-num">17</div></a><a href="/en-us/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en-us/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/en-us/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/en-us/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/en-us/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/en-us/links/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page" href="/en-us/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-solid fa-language"></i><span> Language</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="https://blog.2nfree.com"><i class="fa-fw fa-solid fa-language"></i><span> 简体中文</span></a></li><li><a class="site-page child" href="https://blog.2nfree.com/en-us"><i class="fa-fw fa-solid fa-language"></i><span> English</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image:url(/en-us/images/background-light.webp)"><nav id="nav"><span id="blog-info"><a href="/en-us/" title="Gengar's Pokeball"><img class="site-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/en-us/images/logo.svg"><span class="site-name">Gengar's Pokeball</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en-us/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/en-us/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/en-us/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/en-us/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/en-us/links/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page" href="/en-us/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-solid fa-language"></i><span> Language</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="https://blog.2nfree.com"><i class="fa-fw fa-solid fa-language"></i><span> 简体中文</span></a></li><li><a class="site-page child" href="https://blog.2nfree.com/en-us"><i class="fa-fw fa-solid fa-language"></i><span> English</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Redis Transactions And Configuration</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-06-27T08:03:03.000Z" title="Created 2022-06-27 16:03:03">2022-06-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-08-26T02:02:45.637Z" title="Updated 2024-08-26 10:02:45">2024-08-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/en-us/categories/Redis/">Redis</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">2.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>12mins</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><div class="note blue flat"><p>当前文档有中文版本：<a href="/2022/06/27/redis-config/">点击这里切换到中文</a>.</p></div><h1 id="Transaction"><a href="#Transaction" class="headerlink" title="Transaction"></a>Transaction</h1><p>The essence of a Redis transaction is a collection of commands where all commands within the transaction are serialized and executed sequentially. The characteristics include atomicity, sequentiality, and exclusivity.<br>Redis transactions do not have the concept of isolation levels. All commands in the transaction are not directly executed; they are only executed when the execution command is issued.<br>While individual Redis commands maintain atomicity, a transaction does not guarantee atomicity.</p><h2 id="Execution-of-a-Redis-transaction"><a href="#Execution-of-a-Redis-transaction" class="headerlink" title="Execution of a Redis transaction"></a>Execution of a Redis transaction</h2><p>Start the transaction (using MULTI).<br>Queue the commands.<br>Execute the transaction (using EXEC).<br>The command to discard the transaction is DISCARD.</p><h2 id="Transaction-exceptions-in-Redis"><a href="#Transaction-exceptions-in-Redis" class="headerlink" title="Transaction exceptions in Redis"></a>Transaction exceptions in Redis</h2><p>Compilation Exception (Syntax Error in Code or Command): If there is a syntax error in any command within the transaction, none of the commands in the transaction will be executed.<br>Runtime Exception: If there is a runtime error in the transaction queue, the commands that are error-free will be executed normally when the transaction is executed, while the erroneous command will throw an exception.</p><h2 id="Locks"><a href="#Locks" class="headerlink" title="Locks"></a>Locks</h2><h3 id="Pessimistic-locks"><a href="#Pessimistic-locks" class="headerlink" title="Pessimistic locks"></a>Pessimistic locks</h3><p>| Pessimistic Lock: This approach assumes that issues may occur at any time, so it locks the resource whenever an operation is performed to prevent conflicts.</p><h3 id="Optimistic-locks"><a href="#Optimistic-locks" class="headerlink" title="Optimistic locks"></a>Optimistic locks</h3><p>| Optimistic Lock: This approach assumes that conflicts or issues are unlikely to happen. It doesn’t lock the resource during the operation. Instead, it checks if the data has been modified by someone else before committing the update.<br>| - Getting the Version: Before updating data, the version of the data is retrieved.<br>| - Comparing the Version: During the update, the version is compared to ensure no one else has modified the data in the meantime.</p><p>Watch Command: Use WATCH [key] to monitor the object for changes before making updates.<br>Unlock Command: Use UNWATCH to release the lock and stop monitoring.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># command 1</span></span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> money 200</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> out 0</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; watch money</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; MULTI</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; decrby money 10</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; incrby out 10</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">exec</span></span><br><span class="line">(nil)</span><br><span class="line"><span class="comment"># command 2</span></span><br><span class="line">127.0.0.1:6379&gt; get money</span><br><span class="line"><span class="string">&quot;200&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> money 1000</span><br><span class="line">OK</span><br></pre></td></tr></table></figure><ol><li>127.0.0.1:6379&gt; set money 200</li></ol><ul><li>This command sets a key money in Redis with a value of 200. The 127.0.0.1:6379 indicates the local address and port connected to the Redis server. The response OK signifies that the operation was successful.</li></ul><ol start="2"><li>127.0.0.1:6379&gt; set out 0</li></ol><ul><li>This command sets another key out with a value of 0. Again, OK indicates that the operation was successful.</li></ul><ol start="3"><li>127.0.0.1:6379&gt; watch money</li></ol><ul><li>Here, the WATCH command is used to monitor the key money. The WATCH command makes Redis keep an eye on this key before executing the transaction. If the value of money is modified by another client before the transaction is executed, the transaction will be aborted. OK indicates that the key is being successfully watched.</li></ul><ol start="4"><li>127.0.0.1:6379&gt; MULTI</li></ol><ul><li>The MULTI command begins a transaction. All commands issued after MULTI and before EXEC are queued up and will be executed atomically when EXEC is called. The response OK confirms that the transaction has started.</li></ul><ol start="5"><li>127.0.0.1:6379&gt; decrby money 10</li></ol><ul><li>The DECRBY command decreases the value of money by 10. Since this is inside a transaction, the command is queued, and QUEUED indicates that the command has been successfully added to the transaction queue.</li></ul><ol start="6"><li>127.0.0.1:6379&gt; incrby out 10</li></ol><ul><li>The INCRBY command increases the value of out by 10. Like the previous command, QUEUED indicates that it has been added to the transaction queue.</li></ul><ol start="7"><li>127.0.0.1:6379&gt; exec</li></ol><ul><li>The EXEC command executes all the commands queued in the transaction. If the money key (which was being watched) was modified by another client after the WATCH command but before EXEC, then the transaction will be aborted, and none of the commands will be executed.</li><li>In this case, the response (nil) indicates that the money key was indeed modified by another client, causing the transaction to be aborted and no commands to be executed.</li></ul><p>In summary, this code attempts to decrease the value of money and increase the value of out within a transaction. However, because the money key was modified by another client before the transaction was executed, the transaction was aborted, and no changes were applied.</p><h1 id="Config"><a href="#Config" class="headerlink" title="Config"></a>Config</h1><p>Redis commands are case-insensitive, meaning you can enter commands in uppercase, lowercase, or a combination of both, and they will be interpreted the same way. For example, SET, set, and SeT are all valid and will perform the same operation. This allows flexibility in how commands are written and executed.</p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/en-us/2022/06/27/redis-config/redis-config1.webp"><p>In Redis, it is possible to include other configuration files within a primary configuration file. This allows for better organization and modularity of configuration settings. You can use the include directive in the main Redis configuration file to include other configuration files.<br>This would include the configuration settings from other-config.conf into your main Redis configuration. You can include multiple files this way by adding multiple include directives.<br>This feature is useful when you want to separate certain configuration aspects, such as security settings, network settings, or performance tuning parameters, into different files and then bring them all together in the main configuration file.</p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/en-us/2022/06/27/redis-config/redis-config2.webp"><h2 id="Network"><a href="#Network" class="headerlink" title="Network"></a>Network</h2><p>The bind directive specifies the network interface addresses that Redis will listen on. By default, Redis binds to all network interfaces, which could expose the server to the internet if not properly configured. You can limit this exposure by specifying one or more IP addresses.</p><p>The protected-mode directive is a security feature introduced to prevent unintended exposure of Redis instances to the internet.<br>When protected-mode is set to yes (which is the default), Redis will only accept connections from the loopback address (127.0.0.1) unless you have explicitly configured the bind directive or set a password with requirepass.<br>If Redis detects that it is being accessed from an external IP and protected-mode is enabled, it will refuse connections and log a warning.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">bind</span> 127.0.0.1</span><br><span class="line">protected-mode <span class="built_in">yes</span></span><br><span class="line">port 6379</span><br></pre></td></tr></table></figure><h2 id="General"><a href="#General" class="headerlink" title="General"></a>General</h2><p>The daemonize directive controls whether Redis runs as a daemon. By default, this option is set to no, which means Redis runs in the foreground. If you want Redis to run as a background process, you need to set this option to yes.</p><p>When daemonize is set to yes, Redis will start in the background and will write its process ID (PID) to a file, usually specified by the pidfile directive in the configuration file. This allows you to manage the Redis process more easily, for example, by stopping or restarting it using standard tools like kill.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">daemonize <span class="built_in">yes</span></span><br><span class="line">pidfile /var/run/redis_6379.pid</span><br><span class="line"><span class="comment"># log</span></span><br><span class="line"><span class="comment"># Specify the server verbosity level.</span></span><br><span class="line"><span class="comment"># This can be one of:</span></span><br><span class="line"><span class="comment"># debug (a lot of information, useful for development/testing)</span></span><br><span class="line"><span class="comment"># verbose (many rarely useful info, but not a mess like the debug level)</span></span><br><span class="line"><span class="comment"># notice (moderately verbose, what you want in production probably) </span></span><br><span class="line"><span class="comment"># warning (only very important / critical messages are logged)</span></span><br><span class="line">loglevel notice</span><br><span class="line">logfile </span><br><span class="line">database 16</span><br><span class="line">always-show-logo <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><h2 id="RDB"><a href="#RDB" class="headerlink" title="RDB"></a>RDB</h2><p>These save directives define when Redis should automatically save a snapshot of the dataset to disk. The format is save<seconds><changes>, where Redis will perform a save if at least<changes>keys have been modified in the last<seconds>seconds.</seconds></changes></changes></seconds></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#  Save a snapshot if at least one key has been modified in the last 900 seconds (15 minutes).</span></span><br><span class="line">save 900 1</span><br><span class="line"><span class="comment"># Save a snapshot if at least 10 keys have been modified in the last 300 seconds (5 minutes).</span></span><br><span class="line">save 300 10 </span><br><span class="line"><span class="comment"># Save a snapshot if at least 10,000 keys have been modified in the last 60 seconds (1 minute).</span></span><br><span class="line">save 60 10000</span><br><span class="line">stop-writes-on-bgsave-error <span class="built_in">yes</span></span><br><span class="line">rdbcompression <span class="built_in">yes</span></span><br><span class="line">rdbchecksum <span class="built_in">yes</span></span><br><span class="line"><span class="built_in">dir</span> ./</span><br></pre></td></tr></table></figure><ul><li>stop-writes-on-bgsave-error: If an error occurs during the background saving process (BGSAVE), Redis will stop accepting writes to avoid potential data loss. This setting is a safety mechanism to prevent further modifications to the dataset when a persistence error has occurred.</li><li>rdbcompression: Enables LZF compression for the RDB file. This reduces the size of the snapshot file on disk, but it may increase CPU usage during the save process. It is generally recommended to keep this enabled unless disk space is not a concern and you want to minimize CPU usage.</li><li>rdbchecksum: Enables a checksum at the end of the RDB file. This ensures the integrity of the file, allowing Redis to detect potential corruption. The trade-off is a small performance cost during save and load operations.</li><li>dir: Specifies the directory where the RDB file will be saved. The .&#x2F; indicates the current directory where the Redis server was started. You can change this to an absolute path if you want to store the RDB file in a specific location on the filesystem.</li></ul><h2 id="Security"><a href="#Security" class="headerlink" title="Security"></a>Security</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">config <span class="built_in">set</span> requirepass 123456</span><br><span class="line">auth 123456</span><br><span class="line">maxclients 10000</span><br><span class="line">maxmemory &lt;byte&gt;</span><br><span class="line">maxmemory-policy noeviction</span><br></pre></td></tr></table></figure><ul><li>config set requirepass: Sets the password required to authenticate clients connecting to the Redis server. In this example, the password is set to 123456. After setting a password, clients must authenticate using the AUTH command before they can execute any other commands.</li><li>auth: This command is used by clients to authenticate with the Redis server using the password set by requirepass. In this example, the client uses 123456 as the password to authenticate.</li><li>maxclients: Limits the maximum number of clients that can be connected to the Redis server simultaneously. In this example, the maximum is set to 10,000. If the limit is reached, Redis will start rejecting new connections with an error until some clients disconnect.</li><li>maxmempoy: Sets the maximum amount of memory that Redis is allowed to use. The value should be specified in bytes (e.g., maxmemory 2gb for 2 gigabytes). Redis will start applying the configured eviction policy when this memory limit is reached.</li><li>maxmemory-policy: Defines the strategy Redis will use when the memory limit (maxmemory) is reached.<ul><li>noeviction: Default setting. Redis will not evict any keys when the memory limit is reached. Instead, it will return an error to any write commands that would require more memory.</li><li>allkeys-lru: Redis will evict the least recently used (LRU) keys from all keys to make room for new data.</li><li>volatile-lru: Redis will evict the least recently used (LRU) keys only from keys that have an expiration set (expire).</li><li>allkeys-random: Redis will randomly evict keys from all keys to free up memory.</li><li>volatile-random: Redis will randomly evict keys only from those that have an expiration set (expire).</li><li>volatile-ttl: Redis will evict keys with the shortest remaining time to live (TTL) from those with an expiration set (expire).</li></ul></li></ul><h2 id="AOF"><a href="#AOF" class="headerlink" title="AOF"></a>AOF</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">appendonly no</span><br><span class="line">appendfilename <span class="string">&quot;appendonly.aof&quot;</span></span><br><span class="line">appendfsync always</span><br><span class="line">appendfsync everysec</span><br><span class="line">appendfsync no</span><br></pre></td></tr></table></figure><ul><li>appendonly: This setting controls whether Redis uses the Append-Only File (AOF) for persistence. By default, it is set to no, meaning AOF is disabled, and Redis relies on RDB (Redis Database) snapshots for persistence. The RDB method is typically sufficient for most cases because it is faster and consumes less disk space, though it might result in more data loss compared to AOF in the event of a crash.</li><li>appendfilename: Specifies the name of the AOF file. The default name is appendonly.aof. This file logs every write operation received by the server, allowing Redis to rebuild the dataset by replaying the AOF file if it needs to recover.</li><li>appendfsync<ul><li>always: Every write operation is immediately flushed to disk (fsync), ensuring the highest level of data durability but at a significant performance cost. This setting guarantees that no data will be lost, but it slows down the server due to the constant disk I&#x2F;O operations.</li><li>everysec: Redis will flush data to disk once every second. This is a good compromise between performance and data safety, as it balances the risk of losing up to one second’s worth of data with relatively low impact on performance. This is the recommended setting for most use cases.</li><li>no: Redis will not explicitly flush data to disk. Instead, the operating system handles the flushing, which is the fastest option but offers no guarantees about when the data will be safely written to disk. This could result in significant data loss if the system crashes before the OS syncs the data.</li></ul></li></ul></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://blog.2nfree.com/en-us">komorebi</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://blog.2nfree.com/en-us/2022/06/27/redis-config/">https://blog.2nfree.com/en-us/2022/06/27/redis-config/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/en-us/tags/Linux/">Linux</a><a class="post-meta__tags" href="/en-us/tags/Shell/">Shell</a><a class="post-meta__tags" href="/en-us/tags/Redis/">Redis</a></div><div class="post_share"><div class="social-share" data-image="/en-us/images/avatar.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="/en-us/pluginsSrc/butterfly-extsrc/sharejs/dist/css/share.min.css?v=1.1.3" media="print" onload='this.media="all"'><script src="/en-us/pluginsSrc/butterfly-extsrc/sharejs/dist/js/social-share.min.js?v=1.1.3" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/en-us/2023/02/17/deploy-k8s-with-kubeadm/" title="Deploy Kubernetes With Kubeadm"><div class="cover" style="background:var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">Deploy Kubernetes With Kubeadm</div></div></a></div><div class="next-post pull-right"><a href="/en-us/2022/06/26/redis-command/" title="Redis Commands and Data Types"><div class="cover" style="background:var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next</div><div class="next_info">Redis Commands and Data Types</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/en-us/2022/06/26/redis-command/" title="Redis Commands and Data Types"><div class="cover" style="background:var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-06-26</div><div class="title">Redis Commands and Data Types</div></div></a></div><div><a href="/en-us/2022/06/25/install-redis/" title="Install Redis"><div class="cover" style="background:var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-06-25</div><div class="title">Install Redis</div></div></a></div><div><a href="/en-us/2022/04/05/install-nginx/" title="Nginx Compilation Installation and Configuration"><div class="cover" style="background:var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-05</div><div class="title">Nginx Compilation Installation and Configuration</div></div></a></div></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/en-us/images/avatar.png" onerror='this.onerror=null,this.src="/en-us/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">komorebi</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/en-us/archives/"><div class="headline">Articles</div><div class="length-num">29</div></a><a href="/en-us/tags/"><div class="headline">Tags</div><div class="length-num">17</div></a><a href="/en-us/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/2nfree"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/2nfree" target="_blank" title="Github"><i class="fab fa-github" style="color:#24292e"></i></a><a class="social-icon" href="mailto:komorebi2333@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color:#ffa07a"></i></a><a class="social-icon" href="https://twitter.com/2Nfree" target="_blank" title="Twitter"><i class="fa-brands fa-x-twitter" style="color:#4a7dbe"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Transaction"><span class="toc-number">1.</span> <span class="toc-text">Transaction</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Execution-of-a-Redis-transaction"><span class="toc-number">1.1.</span> <span class="toc-text">Execution of a Redis transaction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Transaction-exceptions-in-Redis"><span class="toc-number">1.2.</span> <span class="toc-text">Transaction exceptions in Redis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Locks"><span class="toc-number">1.3.</span> <span class="toc-text">Locks</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Pessimistic-locks"><span class="toc-number">1.3.1.</span> <span class="toc-text">Pessimistic locks</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Optimistic-locks"><span class="toc-number">1.3.2.</span> <span class="toc-text">Optimistic locks</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Config"><span class="toc-number">2.</span> <span class="toc-text">Config</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Network"><span class="toc-number">2.1.</span> <span class="toc-text">Network</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#General"><span class="toc-number">2.2.</span> <span class="toc-text">General</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RDB"><span class="toc-number">2.3.</span> <span class="toc-text">RDB</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Security"><span class="toc-number">2.4.</span> <span class="toc-text">Security</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AOF"><span class="toc-number">2.5.</span> <span class="toc-text">AOF</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/en-us/2024/08/15/some-ways-enhance-wsl-experience/" title="Some Ways to Enhance Your WSL Experience">Some Ways to Enhance Your WSL Experience</a><time datetime="2024-08-15T07:25:56.000Z" title="Created 2024-08-15 15:25:56">2024-08-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/en-us/2024/07/04/cicd-in-kubernetes-based-jenkins-2/" title="从零实现CI/CD（二）- Jenkins 配置流水线">从零实现CI/CD（二）- Jenkins 配置流水线</a><time datetime="2024-07-04T07:41:11.000Z" title="Created 2024-07-04 15:41:11">2024-07-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/en-us/2024/05/22/kubernetes-logging-collection-4/" title="Kubernetes 日志收集（四），基于 Fluent-bit Daemonset 的日志收集">Kubernetes 日志收集（四），基于 Fluent-bit Daemonset 的日志收集</a><time datetime="2024-05-22T10:26:58.000Z" title="Created 2024-05-22 18:26:58">2024-05-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/en-us/2024/05/13/kubernetes-logging-collection-3/" title="Kubernetes 日志收集（三），Logging operator 中使用 concat 多行合并相关问题">Kubernetes 日志收集（三），Logging operator 中使用 concat 多行合并相关问题</a><time datetime="2024-05-13T04:26:58.000Z" title="Created 2024-05-13 12:26:58">2024-05-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/en-us/2024/03/25/keda/" title="KEDA - 基于 Kubernetes 的事件驱动自动缩放器">KEDA - 基于 Kubernetes 的事件驱动自动缩放器</a><time datetime="2024-03-25T06:48:39.000Z" title="Created 2024-03-25 14:48:39">2024-03-25</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2024 By komorebi</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/en-us/js/utils.js?v=4.13.0"></script><script src="/en-us/js/main.js?v=4.13.0"></script><script src="/en-us/pluginsSrc/medium-zoom/dist/medium-zoom.min.js?v=1.1.0"></script><script src="/en-us/pluginsSrc/instant.page/instantpage.js?v=5.2.0" type="module"></script><script src="/en-us/pluginsSrc/vanilla-lazyload/dist/lazyload.iife.min.js?v=17.8.8"></script><script>function panguFn(){"object"==typeof pangu?pangu.autoSpacingPage():getScript("/en-us/pluginsSrc/pangu/dist/browser/pangu.min.js?v=4.0.7").then(()=>{pangu.autoSpacingPage()})}function panguInit(){panguFn()}document.addEventListener("DOMContentLoaded",panguInit)</script><div class="js-pjax"><script>(()=>{const e=e=>"dark"===e?"dark":"light",t=()=>{const t=Object.assign({src:"https://giscus.app/client.js","data-repo":"2nfree/2nfree.github.io","data-repo-id":"R_kgDOJEANRA","data-category-id":"DIC_kwDOJEANRM4CcNhM","data-mapping":"pathname","data-theme":e(document.documentElement.getAttribute("data-theme")),"data-reactions-enabled":"1",crossorigin:"anonymous",async:!0},null),a=document.createElement("script");for(let e in t)a.setAttribute(e,t[e]);document.getElementById("giscus-wrap").appendChild(a)};btf.addGlobalFn("themeChange",t=>{(e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")})({setConfig:{theme:e(t)}})},"giscus"),btf.loadComment(document.getElementById("giscus-wrap"),t)})()</script></div><script defer id="fluttering_ribbon" mobile="true" src="/en-us/pluginsSrc/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js?v=1.1.3"></script><script id="click-heart" src="/en-us/pluginsSrc/butterfly-extsrc/dist/click-heart.min.js?v=1.1.3" async mobile="false"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"></div></div><hr><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/en-us/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>